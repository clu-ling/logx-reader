taxonomy: org/parsertongue/reader/grammars/logx/taxonomy.yml
#taxonomy: file:///home/hahnpowell/repos/clu-ling/logx-reader/reader/grammars/logx/taxonomy.yml

vars:
  # NOTE: change pathPrefix for development
  #pathPrefix: "org/parsertongue/reader/grammars/logx"
  pathPrefix: "org/parsertongue/reader/grammars/logx"
  #pathPrefix: "org/parsertongue/reader/grammars/logx"
  wh-words-en: "how|that|what|whatever|when|whenever|where|which|who|whoever|whom|whose|why"

rules:

  #- import: ${pathPrefix}/entities/avoid.yml

######################################
# Concepts
######################################

  - name: "org-ner"
    label: Organization
    priority: 3
    example: "DoD"
    type: token
    pattern: |
      [entity="B-ORG"]
      # extant mentions should take priority
      [entity="I-ORG" & !mention=/./]* 

  - name: "loc-ner"
    label: Location
    type: token
    pattern: |
      [entity="B-LOC"]
      [entity="I-LOC"]*
      [word=/^\,$/]? 
      [word=/^[A-Z]{2}$/]?
      #last 2 lines allow for things like "Hamburg, DE"; "Tucson, AZ"

  # https://en.wikipedia.org/wiki/Twenty-foot_equivalent_unit
  - name: "units"
    label: Unit
    type: token
    pattern: |
      [lemma=metric]? [lemma=/(?i)^(TEU|ton|pound|kg)s?$/]

  - name: "quantity"
    label: Quantity
    type: token
    pattern: |
      [word=/^\d/] (?=@Unit)

  - name: "quantifier-1"
    label: Quantifier
    type: token
    pattern: |
      [lemma=/^(many|much|few|some)$/]
      |
      [lemma=a]? [lemma=lot] of
  
  - name: "quantified-cargo"
    label: QuantifiedCargo
    type: token
    # promotes Concept -> Cargo
    # FIXME: assumes we're only quantifying cargo
    action: handleQuantifiedCargo
    pattern: |
      @unit:Unit of @concept:Concept
  
  # FIXME: introduce a more principled way of identifying cargo
  - name: "cargo"
    label: Cargo
    type: token
    pattern: |
      [tag=/^N/] cargo
  
  - name: "shipment-of-trigger"
    label: ShipmentOfTrigger
    type: token
    pattern: |
      [lemma=shipment] of

  - name: "shipment-of-cargo"
    label: Cargo
    type: token
    pattern: |
      (?<= @ShipmentOfTrigger) @Concept

  - name: "shipment-of"
    label: ShipmentOf
    type: token
    pattern: |
      @trigger:ShipmentOfTrigger @cargo:Cargo

  - name: "unknown-cargo"
    label: UnspecifiedCargo
    type: token
    pattern: |
      # "the cargo"
      (?<=[!tag=/^N/]) cargo

    
  # - name: "concept"
  #   label: Concept
  #   type: token
  #   pattern: |
  #     [entity="B-Concept"]
  #     [entity="I-Concept"]*

  # # *ility
  # - name: "ility-concept"
  #   label: Concept
  #   type: token
  #   pattern: |
  #     [tag=/^(JJ|NN)/]* [lemma=/ility$/ & entity=O & !mention=/./]

  - import: ${pathPrefix}/entities/time-expressions.yml

  - import: ${pathPrefix}/entities/xp.yml
  
